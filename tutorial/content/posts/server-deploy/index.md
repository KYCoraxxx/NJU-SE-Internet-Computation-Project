---
title: "如何将网站部署到服务器"
description: 本页面将简要介绍如何使用nginx搭建个人网站服务器
date: 2022-10-31
image: cover.jpg
math: 
license: 
categories: 综合
tags: [ server, Nginx ]
hidden: false
comments: true
draft: true
---

## 服务器选择

### 校内服务器

如果你有多余的电脑，你可以直接用校内局域网IP搭建校内服务器，但如果这个电脑的操作系统不是Linux操作系统，作者不建议这样操作，因为Windows系统的相关操作相当复杂（下面会提到的网站部署工具`Nginx`对Windows系统的支持不太好，你也可以自己去摸索一下`Tom🐱`的使用）

当然你甚至可以和你的`ISP(Internet Service Provider)`联系，向它申请一个公网IP，这样你的电脑就成为了一台云服务器😄，不过要申请一个公网IP是需要一定必要的理由的，作者自己没有这个财力所以就请有这个想法的uu自行摸索辣🌶

### 云服务器平台

目前市面上有众多云服务器平台可供选择，例如阿里云、腾讯云、华为云等等，在完成注册和实名认证（尤其是学生认证）之后就可以多逛逛，哪个平台活动好就在哪个平台入手即可，要恰🍚的都知道吧😀

### 云服务器配置

即使在一个平台的学生特价活动中也有众多服务器配置可供选择，根据配置的不同，其价格也参差不齐

通常来说，最低配置的服务器对于维护个人网站来说已经完全够用（前提是使用Linux系统），在学生计划的加持下价格在60~100💴/年比较合适，可以根据个人愿意投入的资金情况进行选择

如前文所述，作者强烈推荐选择**Linux系统镜像**，Linux系统有诸多好处：

- 系统稳定性强，即使长时间不重启系统也不会crash
- 系统内存/CPU占用小
- 命令行简洁易用，用户权限高，使用自由度极高，所有操作均有记录
- 开发环境可一键配置
- ……

即使是专注于算法的`NOI(National Olympiad in Informatics)`都已经要求参赛选手必须使用Linux系统环境，作为开发者的你还在犹豫什么？

使用Linux的云服务器有助于提升你对Linux操作系统的熟悉程度，同时即使你做了什么逆天操作也可以**一键重装系统**，当你对Linux系统足够熟悉，了解到它的诸多好处之后，你可以安装`WSL(Windows Subsystem for Linux)`让你的Windows电脑顺畅地运行Linux开发环境，具体信息见[链接](https://oi-wiki.org/tools/wsl/)

当你购买了云服务器之后，还会有一些初始化操作需要处理，根据不同的平台而定会有不同的操作方式，这里就不作赘述

## 本地工具支持

### 文件传输软件

用于在本机与服务器之间交换文件，共有**SSH传输协议，FTP文件传输协议，SFTP文件传输协议**三种，作者推荐第一种，即SSH传输协议，虽然在传输文件的时候速度不如后两种协议，但是可以和后面的软件共用服务器的21号端口，简化服务器的防火墙配置

由于服务器的性能受限和网络安全因素考虑，开发过程并不适合在服务器上直接进行，所以一般开发者都是先在本地的电脑上完成开发过程，再将release版本的文件传输到服务器上并进行部署

作者常用的软件是FileZilla，你不妨自己去尝试一下或者用用别的😄

### 远程终端软件

在每个云服务器平台上都会有云控制台的选项，但它的使用有时并不那么方便，尤其是当你需要操作别人的服务器时，你显然不能直接找人家要他的平台账号😂，所以需要使用远程终端软件

作者常用的软件是XShell，你不妨自己去尝试一下或者用用别的😄

### 使用上述软件时出现问题

如果你在使用这些软件的时候出现了诸如无法直接登录root账号、用户密码没有配置的问题，肯定是服务器的系统配置文件没有合理配置，请查阅各个云服务器平台提供的FAQ或者手册自行解决

## 服务器工具支持

### Nginx

`Nginx`是一个高性能HTTP和反向代理web服务器，提供了诸如**网站一键部署，反向代理，负载均衡**的强大功能，在使用时，你只需要简单地更改配置文件中的`server`语法块即可完成网站的部署

具体的配置更改需要根据需要自行摸索，Google中也有对`nginx.conf`文件语法的详细解析，这里仅稍作解释

~~~~nginx
user	root; #将nginx的调用者修改为root
http{ #http语法块
	server { #新增服务器配置语法块
		listen 80; #监听端口号，这里以80端口(HTTP)为例
		server_name _; #域名，如果没有可以用_标识
		
		###########################
		#如果有域名需要额外配置其他内容#
		###########################
		
		location / { #网站根目录语法块
			root /usr/share/nginx/html; #网站根目录路径，根据个人存放位置而定
			index index.html index.htm; #网站首页文件，根据个人网站文件而定
		}
        
        #如果你的页面中有php等其他文件，需要再添加其他配置
	}
	##############
	#SSL Settings#
	##############
	#配置SSL证书内容，如果没有则不需要配置
	
	######################
	#Virtual Host Configs#
	######################
	#注意需要注释掉这两条语句，否则你的设置很可能和默认配置冲突
	#include /etc/nginx/conf.d/*.conf;
	#include /etc/nginx/sites-enabled/*;
}
~~~~

在服务器上安装Nginx只需要一条命令即可，你也可以在命令的后面跟上-y参数，这样就不用在安装的过程中再次确认

~~~~bash
sudo apt-get install nginx	#针对Ubuntu用户
yum install nginx	#针对centOS用户
~~~~

## 常用命令

~~~~bash
find / -name <dir/filename>	#在根目录下查找文件/目录名的路径
ls -a	#详细地展开当前目录下的内容
cd <dirname>	#切换目录
vim <filename>	#使用vim编辑器打开文件
netstat -ntlp	#查看网络端口占用
nginx	#启动nginx服务
sudo service nginx restart	#重启nginx服务，但是一般不能成功
kill <pid>	#如果不能用service重启，就只能通过kill命令强行终止nginx服务，然后再通过nginx命令重启
~~~~

呃呃作者暂时就想到这么多😴

## SSL证书安装

如果你有一些闲💴，又正好没什么事干，在访问你的网站时总是被提醒**不安全**🤬，那么你就可以为你的网站安装SSL证书

不安全的原因主要有两个：

- 基于HTTP协议的网站通信没有经过加密
- 直接使用公网ip访问网站会暴露服务器位置

安装SSL的步骤如下：

### 购买域名

你需要前往前面提到的各大云服务器平台购买域名，并按照这些平台提供的引导完成域名备案，域名审核以及SSL证书的申请😴

### 添加记录

在域名分配下发完成之后，你需要为域名开启DNS域名解析服务，具体来说，你需要为这个域名添加一条记录，说明这个域名将定向到哪个公网ip😄

### 下载证书

接下来你就可以在域名控制台下载SSL证书，并将它传输到服务器上

### 开放服务器端口

然后，你需要在云服务器的控制台上开放服务器相应端口的**防火墙**或者**安全组**选项

然后在服务器的nginx配置文件中说明需要为这两个端口提供怎样的服务，具体操作如下：

~~~~nginx
http{
    server{
    	listen 443 ssl; #监听443(HTTPS)端口
        server_name yourwebsite.cn; #你的域名
        ssl_certificate _; #按照最下面的配置即可
        ssl_certificate_key _; #按照最下面的配置即可
        #下面的按照配置进行即可，注意根据nginx版本不同有的配置可能不同
    	ssl_session_timeout 5m;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
        ssl_prefer_server_ciphers on;
        location / {
            root ...;
            index ...;
        }
        #如果你的页面中有php等其他文件，需要再添加其他配置
    }
    
    server{ #将80端口的访问重定向到443端口的加密链接进行访问
        listen 80;
        server_name yourwebsite.cn; #你的域名
        return 301 https://$host$request_uri; #301是HTTP状态码，标识正常访问
    }
    ###
    #SSL Settings
    ###
    #如果是国密证书，配置会有一些不同，具体可以按照相关云服务器平台的文档来操作
    ssl_certificate yourwebsite.cn_bundle.crt; #填写你的证书文件路径
    ssl_certificate_key yourwebsite.cn.key; #填写你的证书文件密钥
}
~~~~

### 测试域名连通性

你可以进入`DNSPod`系统检测你的域名解析和服务器的连接是否正常，能否Ping通等，如果可以，就可以使用域名访问你的网站辣🌶
